<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="container mt-3">

<nav class="nav nav-tabs mb-3">
    <a class="nav-link active" id="tab-shops" href="#" onclick="loadShops()">üè™ –ú–∞–≥–∞–∑–∏–Ω—ã</a>
    <a class="nav-link" id="tab-items" href="#" onclick="loadItems()">üì¶ –¢–æ–≤–∞—Ä—ã</a>
    <a class="nav-link" id="tab-employees" href="#" onclick="loadEmployees()">üë®‚Äçüíº –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
    <a class="nav-link" id="tab-transactions" href="#" onclick="loadTransactions()">üí∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</a>
</nav>

<div id="content"></div>

<script>
    function loadShops() {
        $.get("http://localhost:8081/shop", function(data) {
            let table = `
                <h3>üè™ –ú–∞–≥–∞–∑–∏–Ω—ã</h3>
                <button class="btn btn-success mb-2" onclick="showShopForm()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                <table class="table">
                    <thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ê–¥—Ä–µ—Å</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
                    <tbody>${data.map(shop => `
                        <tr>
                            <td>${shop.id}</td>
                            <td>${shop.name}</td>
                            <td>${shop.address}</td>
                            <td>
                                <button class="btn btn-warning" onclick="editShop(${shop.id})">‚úèÔ∏è</button>
                                <button class="btn btn-danger" onclick="deleteShop(${shop.id})">üóë</button>
                            </td>
                        </tr>
                    `).join('')}</tbody>
                </table>`;
            $('#content').html(table);
        });
    }

    function showShopForm() {
        const form = `
            <h3>–î–æ–±–∞–≤–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω</h3>
            <form id="shop-form">
                <div class="mb-3">
                    <label for="shop-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="shop-name" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="shop-address" class="form-label">–ê–¥—Ä–µ—Å</label>
                    <input type="text" id="shop-address" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="loadShops()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </form>
        `;
        $('#content').html(form);

        $('#shop-form').on('submit', function(event) {
            event.preventDefault();
            const name = $('#shop-name').val();
            const address = $('#shop-address').val();
            $.post('http://localhost:8081/shop', { name, address }, function() {
                loadShops();
            });
        });
    }

    function editShop(id) {
        $.get(`http://localhost:8081/shop/${id}`, function(shop) {
            const form = `
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞–≥–∞–∑–∏–Ω</h3>
                <form id="shop-form">
                    <div class="mb-3">
                        <label for="shop-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                        <input type="text" id="shop-name" class="form-control" value="${shop.name}" required>
                    </div>
                    <div class="mb-3">
                        <label for="shop-address" class="form-label">–ê–¥—Ä–µ—Å</label>
                        <input type="text" id="shop-address" class="form-control" value="${shop.address}" required>
                    </div>
                    <button type="submit" class="btn btn-warning">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" onclick="loadShops()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                </form>
            `;
            $('#content').html(form);

            $('#shop-form').on('submit', function(event) {
                event.preventDefault();
                const name = $('#shop-name').val();
                const address = $('#shop-address').val();
                $.ajax({
                    url: `http://localhost:8081/shop/${id}`,
                    type: 'PUT',
                    data: { name, address },
                    success: function() {
                        loadShops();
                    }
                });
            });
        });
    }

    function deleteShop(id) {
        if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–∞–≥–∞–∑–∏–Ω?")) {
            $.ajax({
                url: `http://localhost:8081/shop/${id}`,
                type: 'DELETE',
                success: function() {
                    loadShops();
                }
            });
        }
    }

    function loadItems() {
        $.get("http://localhost:8081/electro-item", function(data) {
            let table = `
                <h3>üì¶ –¢–æ–≤–∞—Ä—ã</h3>
                <button class="btn btn-success mb-2" onclick="showItemForm()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                <table class="table">
                    <thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–¶–µ–Ω–∞</th><th>–¢–∏–ø</th><th>–ê—Ä—Ö–∏–≤–Ω—ã–π</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
                    <tbody>${data.map(item => `
                        <tr>
                            <td>${item.id}</td>
                            <td>${item.name}</td>
                            <td>${item.price}</td>
                            <td>${item.electronicType}</td>
                            <td>${item.archive ? '–î–∞' : '–ù–µ—Ç'}</td>
                            <td>
                                <button class="btn btn-warning" onclick="editItem(${item.id})">‚úèÔ∏è</button>
                                <button class="btn btn-danger" onclick="deleteItem(${item.id})">üóë</button>
                            </td>
                        </tr>
                    `).join('')}</tbody>
                </table>`;
            $('#content').html(table);
        });
    }

    function showItemForm() {
        const form = `
            <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
            <form id="item-form">
                <div class="mb-3">
                    <label for="item-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="item-name" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="item-price" class="form-label">–¶–µ–Ω–∞</label>
                    <input type="number" id="item-price" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="item-type" class="form-label">–¢–∏–ø —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏</label>
                    <input type="text" id="item-type" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="item-archive" class="form-label">–ê—Ä—Ö–∏–≤–Ω—ã–π</label>
                    <input type="checkbox" id="item-archive" class="form-check-input">
                </div>
                <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="loadItems()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </form>
        `;
        $('#content').html(form);

        $('#item-form').on('submit', function(event) {
            event.preventDefault();
            const name = $('#item-name').val();
            const price = $('#item-price').val();
            const electronicType = $('#item-type').val();
            const archive = $('#item-archive').is(':checked');
            $.post('http://localhost:8081/electro-item', { name, price, electronicType, archive }, function() {
                loadItems();
            });
        });
    }

    function editItem(id) {
        $.get(`http://localhost:8081/electro-item/${id}`, function(item) {
            const form = `
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h3>
                <form id="item-form">
                    <div class="mb-3">
                        <label for="item-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                        <input type="text" id="item-name" class="form-control" value="${item.name}" required>
                    </div>
                    <div class="mb-3">
                        <label for="item-price" class="form-label">–¶–µ–Ω–∞</label>
                        <input type="number" id="item-price" class="form-control" value="${item.price}" required>
                    </div>
                    <div class="mb-3">
                        <label for="item-type" class="form-label">–¢–∏–ø —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏</label>
                        <input type="text" id="item-type" class="form-control" value="${item.electronicType}" required>
                    </div>
                    <div class="mb-3">
                        <label for="item-archive" class="form-label">–ê—Ä—Ö–∏–≤–Ω—ã–π</label>
                        <input type="checkbox" id="item-archive" class="form-check-input" ${item.archive ? 'checked' : ''}>
                    </div>
                    <button type="submit" class="btn btn-warning">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" onclick="loadItems()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                </form>
            `;
            $('#content').html(form);

            $('#item-form').on('submit', function(event) {
                event.preventDefault();
                const name = $('#item-name').val();
                const price = $('#item-price').val();
                const electronicType = $('#item-type').val();
                const archive = $('#item-archive').is(':checked');
                $.ajax({
                    url: `http://localhost:8081/electro-item/${id}`,
                    type: 'PUT',
                    data: { name, price, electronicType, archive },
                    success: function() {
                        loadItems();
                    }
                });
            });
        });
    }

    function deleteItem(id) {
        if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?")) {
            $.ajax({
                url: `http://localhost:8081/electro-item/${id}`,
                type: 'DELETE',
                success: function() {
                    loadItems();
                }
            });
        }
    }

    function loadEmployees() {
        $.get("http://localhost:8081/employee", function(data) {
            let table = `
                <h3>üë®‚Äçüíº –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</h3>
                <button class="btn btn-success mb-2" onclick="showEmployeeForm()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                <table class="table">
                    <thead><tr><th>ID</th><th>–ò–º—è</th><th>–§–∞–º–∏–ª–∏—è</th><th>–î–æ–ª–∂–Ω–æ—Å—Ç—å</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
                    <tbody>${data.map(employee => `
                        <tr>
                            <td>${employee.id}</td>
                            <td>${employee.firstName}</td>
                            <td>${employee.lastName}</td>
                            <td>${employee.position}</td>
                            <td>
                                <button class="btn btn-warning" onclick="editEmployee(${employee.id})">
                                ‚úèÔ∏è</button>
                                <button class="btn btn-danger" onclick="deleteEmployee(${employee.id})">üóë</button>
                            </td>
                        </tr>
                    `).join('')}</tbody>
                </table>`;
            $('#content').html(table);
        });
    }

    function showEmployeeForm() {
        const form = `
            <h3>–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
            <form id="employee-form">
                <div class="mb-3">
                    <label for="employee-firstname" class="form-label">–ò–º—è</label>
                    <input type="text" id="employee-firstname" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="employee-lastname" class="form-label">–§–∞–º–∏–ª–∏—è</label>
                    <input type="text" id="employee-lastname" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="employee-position" class="form-label">–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
                    <input type="text" id="employee-position" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="loadEmployees()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </form>
        `;
        $('#content').html(form);

        $('#employee-form').on('submit', function(event) {
            event.preventDefault();
            const firstName = $('#employee-firstname').val();
            const lastName = $('#employee-lastname').val();
            const position = $('#employee-position').val();
            $.post('http://localhost:8081/employee', { firstName, lastName, position }, function() {
                loadEmployees();
            });
        });
    }

    function editEmployee(id) {
        $.get(`http://localhost:8081/employee/${id}`, function(employee) {
            const form = `
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
                <form id="employee-form">
                    <div class="mb-3">
                        <label for="employee-firstname" class="form-label">–ò–º—è</label>
                        <input type="text" id="employee-firstname" class="form-control" value="${employee.firstName}" required>
                    </div>
                    <div class="mb-3">
                        <label for="employee-lastname" class="form-label">–§–∞–º–∏–ª–∏—è</label>
                        <input type="text" id="employee-lastname" class="form-control" value="${employee.lastName}" required>
                    </div>
                    <div class="mb-3">
                        <label for="employee-position" class="form-label">–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
                        <input type="text" id="employee-position" class="form-control" value="${employee.position}" required>
                    </div>
                    <button type="submit" class="btn btn-warning">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" onclick="loadEmployees()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                </form>
            `;
            $('#content').html(form);

            $('#employee-form').on('submit', function(event) {
                event.preventDefault();
                const firstName = $('#employee-firstname').val();
                const lastName = $('#employee-lastname').val();
                const position = $('#employee-position').val();
                $.ajax({
                    url: `http://localhost:8081/employee/${id}`,
                    type: 'PUT',
                    data: { firstName, lastName, position },
                    success: function() {
                        loadEmployees();
                    }
                });
            });
        });
    }

    function deleteEmployee(id) {
        if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?")) {
            $.ajax({
                url: `http://localhost:8081/employee/${id}`,
                type: 'DELETE',
                success: function() {
                    loadEmployees();
                }
            });
        }
    }

    function loadTransactions() {
        $.get("http://localhost:8081/transaction", { page: 0, size: 10, sort: false }, function(data) {
            let table = '<h3>üí∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>';
            table += '<table class="table"><thead><tr><th>–¢–æ–≤–∞—Ä</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–î–∞—Ç–∞</th><th>–¢–∏–ø –æ–ø–ª–∞—Ç—ã</th><th>–ú–∞–≥–∞–∑–∏–Ω</th></tr></thead><tbody>';

            data.forEach(transaction => {
                table += `<tr>
                        <td>${transaction.electroName}</td>
                        <td>${transaction.employee.firstName} ${transaction.employee.lastName}</td>
                        <td>${transaction.date}</td>
                        <td>${transaction.purchaseType}</td>
                        <td>${transaction.shop.name}</td>
                    </tr>`;
            });

            table += '</tbody></table>';
            $('#content').html(table);
        }).fail(function(jqXHR, textStatus, errorThrown) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: ", textStatus, errorThrown);
        });
    }

    function showTransactionForm() {
        const form = `
            <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h3>
            <form id="transaction-form">
                <div class="mb-3">
                    <label for="transaction-shop" class="form-label">–ú–∞–≥–∞–∑–∏–Ω</label>
                    <select id="transaction-shop" class="form-select" required>
                        <!-- –°—é–¥–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤ -->
                    </select>
                </div>
                <div class="mb-3">
                    <label for="transaction-amount" class="form-label">–°—É–º–º–∞</label>
                    <input type="number" id="transaction-amount" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="transaction-date" class="form-label">–î–∞—Ç–∞</label>
                    <input type="date" id="transaction-date" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="loadTransactions()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </form>
        `;
        $('#content').html(form);

        $('#transaction-form').on('submit', function(event) {
            event.preventDefault();
            const shopId = $('#transaction-shop').val();
            const amount = $('#transaction-amount').val();
            const date = $('#transaction-date').val();
            $.post('http://localhost:8081/transaction', { shopId, amount, date }, function() {
                loadTransactions();
            });
        });
    }

    function editTransaction(id) {
        $.get(`http://localhost:8081/transaction/${id}`, function(transaction) {
            const form = `
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h3>
                <form id="transaction-form">
                    <div class="mb-3">
                        <label for="transaction-shop" class="form-label">–ú–∞–≥–∞–∑–∏–Ω</label>
                        <select id="transaction-shop" class="form-select" required>
                            <!-- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω —Ç–µ–∫—É—â–∏–π –º–∞–≥–∞–∑–∏–Ω -->
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="transaction-amount" class="form-label">–°—É–º–º–∞</label>
                        <input type="number" id="transaction-amount" class="form-control" value="${transaction.amount}" required>
                    </div>
                    <div class="mb-3">
                        <label for="transaction-date" class="form-label">–î–∞—Ç–∞</label>
                        <input type="date" id="transaction-date" class="form-control" value="${transaction.date}" required>
                    </div>
                    <button type="submit" class="btn btn-warning">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" onclick="loadTransactions()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                </form>
            `;
            $('#content').html(form);

            $('#transaction-form').on('submit', function(event) {
                event.preventDefault();
                const shopId = $('#transaction-shop').val();
                const amount = $('#transaction-amount').val();
                const date = $('#transaction-date').val();
                $.ajax({
                    url: `http://localhost:8081/transaction/${id}`,
                    type: 'PUT',
                    data: { shopId, amount, date },
                    success: function() {
                        loadTransactions();
                    }
                });
            });
        });
    }

    function deleteTransaction(id) {
        if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é?")) {
            $.ajax({
                url: `http://localhost:8081/transaction/${id}`,
                type: 'DELETE',
                success: function() {
                    loadTransactions();
                }
            });
        }
    }
</script>

</body>
</html>